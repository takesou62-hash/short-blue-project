<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shorts Match - YouTubeã‚·ãƒ§ãƒ¼ãƒˆå‹•ç”»ãƒãƒƒãƒãƒ³ã‚°</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.min.js" onerror="alert('Supabaseãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚')"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
            min-height: 100vh;
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        header {
            background: white; padding: 20px; border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 30px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .logo { display: flex; align-items: center; gap: 10px; font-size: 24px; font-weight: bold; color: #0891b2; }
        .btn {
            background: linear-gradient(to right, #06b6d4, #3b82f6); color: white;
            padding: 12px 24px; border-radius: 25px; border: none; font-weight: 600;
            cursor: pointer; transition: all 0.3s; font-size: 1em;
        }
        .btn-large { padding: 18px 40px; font-size: 1.2em; border-radius: 30px; }
        .btn-secondary { background: white; color: #1f2937; border: 3px solid #1f2937; }
        .btn-secondary:hover { background: #1f2937; color: white; }
        .btn:hover { transform: scale(1.05); box-shadow: 0 8px 20px rgba(6,182,212,0.4); }
        .hero { text-align: center; padding: 60px 20px; }
        .hero h1 { font-size: 4em; font-weight: 900; color: #1f2937; margin-bottom: 20px; line-height: 1.2; }
        .gradient-text {
            background: linear-gradient(to right, #06b6d4, #3b82f6);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
        }
        .hero p { font-size: 1.5em; color: #6b7280; margin-bottom: 30px; }
        .features { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 40px 0; }
        .feature-card {
            background: white; padding: 30px; border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: all 0.3s;
        }
        .feature-card:hover { transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0,0,0,0.15); }
        .feature-icon { font-size: 3em; margin-bottom: 15px; }
        .feature-card h3 { font-size: 1.3em; margin-bottom: 10px; color: #1f2937; }
        .editors-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 30px; margin-top: 40px; }
        .editor-card {
            background: white; border-radius: 25px; padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1); transition: all 0.3s;
        }
        .editor-card:hover { transform: translateY(-5px); box-shadow: 0 8px 30px rgba(0,0,0,0.15); border: 2px solid #06b6d4; }
        .editor-header { display: flex; gap: 20px; margin-bottom: 20px; }
        .editor-avatar { width: 80px; height: 80px; border-radius: 20px; border: 4px solid #e0f2fe; }
        .editor-info h3 { font-size: 1.5em; color: #1f2937; margin-bottom: 5px; }
        .specialty { color: #06b6d4; font-weight: 600; margin-bottom: 10px; }
        .rating { font-size: 0.9em; color: #6b7280; }
        .os-badge { display: inline-block; padding: 5px 12px; border-radius: 15px; font-size: 0.85em; font-weight: bold; margin-top: 5px; }
        .os-windows { background: #3b82f6; color: white; }
        .os-mac { background: #1f2937; color: white; }
        .software-section { margin: 20px 0; }
        .software-section h4 { font-weight: 700; margin-bottom: 15px; color: #1f2937; }
        .software-tags { display: flex; flex-wrap: wrap; gap: 10px; }
        .software-tag { padding: 12px 16px; border-radius: 12px; font-weight: 600; font-size: 0.9em; transition: all 0.2s; }
        .software-tag:hover { transform: scale(1.05); }
        .proficiency-badge { display: block; font-size: 0.75em; margin-top: 5px; padding: 3px 8px; border-radius: 10px; font-weight: bold; }
        .pro { background: #fbbf24; color: #78350f; }
        .intermediate { background: rgba(255,255,255,0.7); color: #374151; }
        .filter-section {
            background: white; padding: 30px; border-radius: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 40px; border: 3px solid #e0f2fe;
        }
        .filter-section h3 { font-size: 1.5em; margin-bottom: 20px; color: #1f2937; display: flex; align-items: center; gap: 10px; }
        .filter-group { margin-bottom: 25px; }
        .filter-group label { display: block; font-weight: 600; margin-bottom: 10px; color: #374151; }
        .filter-buttons { display: flex; flex-wrap: wrap; gap: 10px; }
        .filter-btn {
            padding: 10px 20px; border-radius: 15px; border: 2px solid #e5e7eb;
            background: #f9fafb; color: #374151; font-weight: 600; cursor: pointer;
            transition: all 0.3s; font-size: 0.95em;
        }
        .filter-btn:hover { transform: scale(1.05); border-color: #06b6d4; }
        .filter-btn.active { background: linear-gradient(to right, #06b6d4, #3b82f6); color: white; border-color: #06b6d4; box-shadow: 0 4px 12px rgba(6,182,212,0.3); }
        .filter-btn.os-windows.active { background: #3b82f6; border-color: #3b82f6; }
        .filter-btn.os-mac.active { background: #1f2937; border-color: #1f2937; }
        .clear-filters {
            background: transparent; border: 2px solid #ef4444; color: #ef4444;
            padding: 8px 16px; border-radius: 12px; cursor: pointer; font-weight: 600; transition: all 0.3s; font-size: 0.9em;
        }
        .clear-filters:hover { background: #ef4444; color: white; }
        .results-count { margin-top: 20px; padding-top: 20px; border-top: 2px solid #f3f4f6; color: #6b7280; font-size: 0.95em; }
        .results-count span { color: #06b6d4; font-weight: bold; font-size: 1.2em; }
        .portfolio-section { background: #f9fafb; padding: 20px; border-radius: 15px; margin: 20px 0; }
        .video-thumbnails { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 15px 0; }
        .video-thumb { position: relative; aspect-ratio: 9/16; border-radius: 10px; overflow: hidden; cursor: pointer; transition: all 0.3s; }
        .video-thumb:hover { transform: scale(1.05); box-shadow: 0 0 0 4px #06b6d4; }
        .video-thumb img { width: 100%; height: 100%; object-fit: cover; }
        .play-icon {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 50px; height: 50px; background: rgba(255,255,255,0.9); border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-size: 20px;
        }
        .editor-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 20px; padding-top: 20px; border-top: 2px solid #f3f4f6; }
        .price { font-size: 1.5em; font-weight: bold; color: #06b6d4; }
        .btn-consult {
            background: linear-gradient(to right, #06b6d4, #3b82f6); color: white;
            padding: 12px 24px; border-radius: 20px; border: none; font-weight: 600; cursor: pointer; transition: all 0.3s;
        }
        .btn-consult:hover { transform: scale(1.05); box-shadow: 0 5px 15px rgba(6,182,212,0.4); }
        section { margin: 60px 0; }
        .section-title { text-align: center; font-size: 3em; font-weight: bold; margin-bottom: 40px; color: #1f2937; }
        .loading-state { text-align: center; padding: 80px 20px; grid-column: 1/-1; }
        .loading-state .icon { font-size: 4em; margin-bottom: 20px; }
        .loading-state h3 { font-size: 1.8em; color: #1f2937; margin-bottom: 10px; }
        .loading-state p { color: #6b7280; font-size: 1.1em; }
        footer { background: #1f2937; color: #d1d5db; padding: 60px 20px 40px; margin-top: 60px; }
        .footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 40px; max-width: 1200px; margin: 0 auto 40px; }
        .footer-section h4 { color: white; font-size: 1.1em; margin-bottom: 20px; font-weight: 700; }
        .footer-section ul { list-style: none; }
        .footer-section ul li { margin-bottom: 12px; }
        .footer-section a { color: #d1d5db; text-decoration: none; transition: color 0.3s; font-size: 0.95em; }
        .footer-section a:hover { color: #06b6d4; }
        .footer-logo { display: flex; align-items: center; gap: 10px; font-size: 1.3em; font-weight: bold; color: white; margin-bottom: 15px; }
        .footer-bottom { text-align: center; padding-top: 30px; border-top: 1px solid #374151; color: #9ca3af; font-size: 0.9em; max-width: 1200px; margin: 0 auto; }
        @media (max-width: 768px) {
            .hero h1 { font-size: 2em; }
            .editors-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">â–¶ Shorts Match</div>
        </header>

        <section class="hero">
            <h1>ã‚·ãƒ§ãƒ¼ãƒˆå‹•ç”»ã§ã€<br><span class="gradient-text">ã‚ãªãŸã®æ´»å‹•ã‚’åŠ é€Ÿã•ã›ã‚‹</span></h1>
            <p>ãƒ—ãƒ­ã®å‹•ç”»ç·¨é›†è€…ã¨ãƒãƒƒãƒãƒ³ã‚°ã€‚<br>ä½¿ç”¨ã‚½ãƒ•ãƒˆã‹ã‚‰é¸ã¹ã¦ã€æœ€çŸ­24æ™‚é–“ã§é«˜å“è³ªãªã‚·ãƒ§ãƒ¼ãƒˆå‹•ç”»ãŒå®Œæˆã€‚</p>
            <div style="display:flex; gap:20px; justify-content:center; flex-wrap:wrap; margin-top:30px;">
                <button class="btn btn-large" onclick="scrollToEditors()">ç·¨é›†è€…ã‚’æ¢ã™ â–¶</button>
                <button class="btn btn-large btn-secondary" onclick="alert('ç·¨é›†è€…ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ãã¾ã™')">ç·¨é›†è€…ã¨ã—ã¦ç™»éŒ²</button>
            </div>
        </section>

        <section class="features">
            <div class="feature-card"><div class="feature-icon">âš¡</div><h3>æœ€çŸ­24æ™‚é–“ç´å“</h3><p>æ€¥ãã®æ¡ˆä»¶ã«ã‚‚å¯¾å¿œ</p></div>
            <div class="feature-card"><div class="feature-icon">ğŸ›¡ï¸</div><h3>å®‰å¿ƒã®å“è³ªä¿è¨¼</h3><p>ä¿®æ­£å¯¾å¿œè¾¼ã¿</p></div>
            <div class="feature-card"><div class="feature-icon">ğŸ“ˆ</div><h3>å†ç”Ÿæ•°UPå®Ÿç¸¾</h3><p>å¹³å‡150%å¢—åŠ </p></div>
            <div class="feature-card"><div class="feature-icon">âœ¨</div><h3>ãƒ—ãƒ­ç´šã®ä»•ä¸ŠãŒã‚Š</h3><p>æ¥­ç•Œæ¨™æº–ã‚½ãƒ•ãƒˆä½¿ç”¨</p></div>
        </section>

        <section id="editors">
            <h2 class="section-title">ãƒ—ãƒ­ã®ç·¨é›†è€…ã‚’ <span class="gradient-text">ä½¿ç”¨ã‚½ãƒ•ãƒˆã‹ã‚‰æ¢ã™</span></h2>

            <div class="filter-section">
                <h3>âœ¨ çµã‚Šè¾¼ã¿æ¤œç´¢</h3>
                <div class="filter-group">
                    <label>ä½¿ç”¨OS</label>
                    <div class="filter-buttons">
                        <button class="filter-btn active" onclick="filterOS('all', this)">ã™ã¹ã¦</button>
                        <button class="filter-btn os-windows" onclick="filterOS('Windows', this)">ğŸªŸ Windows</button>
                        <button class="filter-btn os-mac" onclick="filterOS('Mac', this)">ğŸ Mac</button>
                    </div>
                </div>
                <div class="filter-group">
                    <label>ä½¿ç”¨å¯èƒ½ãªã‚½ãƒ•ãƒˆï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
                    <div class="filter-buttons">
                        <button class="filter-btn" onclick="toggleSoftware('Premiere Pro', this)">ğŸ¬ Premiere Pro</button>
                        <button class="filter-btn" onclick="toggleSoftware('After Effects', this)">âœ¨ After Effects</button>
                        <button class="filter-btn" onclick="toggleSoftware('Final Cut Pro', this)">ğŸ¥ Final Cut Pro</button>
                        <button class="filter-btn" onclick="toggleSoftware('DaVinci Resolve', this)">ğŸï¸ DaVinci Resolve</button>
                        <button class="filter-btn" onclick="toggleSoftware('Photoshop', this)">ğŸ¨ Photoshop</button>
                        <button class="filter-btn" onclick="toggleSoftware('Cinema 4D', this)">ğŸ­ Cinema 4D</button>
                    </div>
                </div>
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <button class="clear-filters" onclick="clearFilters()">âœ• ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ã‚¯ãƒªã‚¢</button>
                    <div class="results-count" id="resultsCount"></div>
                </div>
            </div>

            <div class="editors-grid" id="editorsGrid">
                <div class="loading-state">
                    <div class="icon">â³</div>
                    <h3>èª­ã¿è¾¼ã¿ä¸­...</h3>
                    <p>ç·¨é›†è€…æƒ…å ±ã‚’å–å¾—ã—ã¦ã„ã¾ã™</p>
                </div>
            </div>
        </section>

        <footer>
            <div class="footer-grid">
                <div class="footer-section">
                    <div class="footer-logo">â–¶ Shorts Match</div>
                    <p style="font-size:0.9em; line-height:1.6;">VTuberãƒ»YouTuberå‘ã‘ã‚·ãƒ§ãƒ¼ãƒˆå‹•ç”»ç·¨é›†ãƒãƒƒãƒãƒ³ã‚°ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </p>
                </div>
                <div class="footer-section">
                    <h4>ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼</h4>
                    <ul>
                        <li><a href="#editors">ç·¨é›†è€…ã‚’æ¢ã™</a></li>
                        <li><a href="#" onclick="alert('æ–™é‡‘ãƒ—ãƒ©ãƒ³'); return false;">æ–™é‡‘ãƒ—ãƒ©ãƒ³</a></li>
                        <li><a href="#" onclick="alert('ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰'); return false;">ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>ç·¨é›†è€…</h4>
                    <ul>
                        <li><a href="#" onclick="alert('ç·¨é›†è€…ç™»éŒ²'); return false;">ç·¨é›†è€…ç™»éŒ²</a></li>
                        <li><a href="#" onclick="alert('æ‰‹æ•°æ–™ã«ã¤ã„ã¦'); return false;">æ‰‹æ•°æ–™ã«ã¤ã„ã¦</a></li>
                        <li><a href="#" onclick="alert('ã‚ˆãã‚ã‚‹è³ªå•'); return false;">ã‚ˆãã‚ã‚‹è³ªå•</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>ã‚µãƒãƒ¼ãƒˆ</h4>
                    <ul>
                        <li><a href="#" onclick="alert('ãŠå•ã„åˆã‚ã›'); return false;">ãŠå•ã„åˆã‚ã›</a></li>
                        <li><a href="#" onclick="alert('åˆ©ç”¨è¦ç´„'); return false;">åˆ©ç”¨è¦ç´„</a></li>
                        <li><a href="#" onclick="alert('ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼'); return false;">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom"><p>&copy; 2026 Shorts Match. All rights reserved.</p></div>
        </footer>
    </div>

    <script>
        // ===== Supabaseè¨­å®š =====
        const SUPABASE_URL      = 'https://dwmgwdhunvanrsautvtj.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR3bWd3ZGh1bnZhbnJzYXV0dnRqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEwNzE1NzMsImV4cCI6MjA4NjY0NzU3M30.A7vam36zcqqwRcgE4ZFrnhiiJjzRpmt0Z3djYY-ixBo';

        // ===== ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼çŠ¶æ…‹ =====
        let selectedOS       = 'all';
        let selectedSoftware = [];

        // ===== ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢è¨­å®š =====
        const SW_COLORS = {
            'Premiere Pro':    { bg: '#ddd6fe', text: '#5b21b6' },
            'After Effects':   { bg: '#dbeafe', text: '#1e40af' },
            'Photoshop':       { bg: '#e0f2fe', text: '#075985' },
            'Final Cut Pro':   { bg: '#e0e7ff', text: '#3730a3' },
            'DaVinci Resolve': { bg: '#fee2e2', text: '#991b1b' },
            'Cinema 4D':       { bg: '#fce7f3', text: '#9f1239' },
        };
        const SW_ICONS = {
            'Premiere Pro': 'ğŸ¬', 'After Effects': 'âœ¨', 'Photoshop': 'ğŸ¨',
            'Final Cut Pro': 'ğŸ¥', 'DaVinci Resolve': 'ğŸï¸', 'Cinema 4D': 'ğŸ­',
        };

        // ===== ã‚«ãƒ¼ãƒ‰ç”Ÿæˆ =====
        function createEditorCard(e) {
            const os      = e.os || 'Windows';
            const swList  = Array.isArray(e.software) ? e.software : [];
            const details = Array.isArray(e.software_details) ? e.software_details : [];
            const videos  = Array.isArray(e.sample_videos) ? e.sample_videos : [];

            const swHTML = (details.length > 0 ? details : swList.map(n => ({ name: n }))).map(s => {
                const c    = SW_COLORS[s.name] || { bg: '#f3f4f6', text: '#374151' };
                const icon = SW_ICONS[s.name]  || 'ğŸ’»';
                const isPro = s.proficiency === 'ãƒ—ãƒ­ç´š';
                return `<div class="software-tag" style="background:${c.bg}; color:${c.text};">
                    ${icon} ${s.name}
                    ${s.proficiency ? `<span class="proficiency-badge ${isPro ? 'pro' : 'intermediate'}">${s.proficiency}</span>` : ''}
                </div>`;
            }).join('');

            const videoHTML = videos.length > 0 ? `
                <div class="portfolio-section">
                    <h4>ä½œå“ã‚µãƒ³ãƒ—ãƒ«</h4>
                    <div class="video-thumbnails">
                        ${videos.slice(0,3).map(v => `
                            <div class="video-thumb" onclick="alert('å‹•ç”»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼')">
                                <img src="https://img.youtube.com/vi/${v.id}/maxresdefault.jpg" alt="${v.title||''}">
                                <div class="play-icon">â–¶</div>
                            </div>`).join('')}
                    </div>
                </div>` : '';

            const avatar = e.avatar || `https://api.dicebear.com/7.x/avataaars/svg?seed=${encodeURIComponent(e.name)}`;

            return `
            <div class="editor-card" data-os="${os}" data-software="${swList.join(',')}">
                <div class="editor-header">
                    <img src="${avatar}" alt="${e.name}" class="editor-avatar">
                    <div class="editor-info">
                        <h3>${e.name}</h3>
                        <div class="specialty">${e.specialty || ''}</div>
                        <div class="rating">â­ ${e.rating || '-'} â€¢ çµŒé¨“ ${e.experience || '-'} â€¢ ${e.projects || 0}ä»¶ã®å®Ÿç¸¾</div>
                        <span class="os-badge os-${os.toLowerCase()}">${os === 'Mac' ? 'ğŸ Mac' : 'ğŸªŸ Windows'}</span>
                    </div>
                </div>
                <div class="software-section">
                    <h4>ä½¿ç”¨å¯èƒ½ãªã‚½ãƒ•ãƒˆ</h4>
                    <div class="software-tags">${swHTML}</div>
                </div>
                <p style="margin:20px 0; color:#6b7280; line-height:1.6;">${e.description || ''}</p>
                ${videoHTML}
                <div class="editor-footer">
                    <div>
                        <div style="font-size:0.9em; color:#6b7280;">ç´æœŸ: ${e.turnaround || 'è¦ç›¸è«‡'}</div>
                        <div class="price">${e.price || 'è¦ç›¸è«‡'}</div>
                    </div>
                    <button class="btn-consult" onclick="showContact('${e.name}')">ç›¸è«‡ã™ã‚‹</button>
                </div>
            </div>`;
        }

        // ===== Supabaseã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾— =====
        async function fetchEditors() {
            const grid = document.getElementById('editorsGrid');
            console.log('[1] fetchEditors é–‹å§‹');
            console.log('[2] window.supabase:', window.supabase);
            try {
                if (!window.supabase) throw new Error('Supabaseãƒ©ã‚¤ãƒ–ãƒ©ãƒªæœªèª­ã¿è¾¼ã¿');
                const client = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                console.log('[3] ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä½œæˆæˆåŠŸ');

                const { data, error } = await client
                    .from('editors')
                    .select('*')
                    .order('rating', { ascending: false });

                console.log('[4] data:', data, '/ error:', error);
                if (error) throw error;

                if (!data || data.length === 0) {
                    grid.innerHTML = `<div class="loading-state">
                        <div class="icon">ğŸ“­</div>
                        <h3>ç™»éŒ²è€…ãŒã„ã¾ã›ã‚“</h3>
                        <p>ç¾åœ¨ã€ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ç·¨é›†è€…ãŒã„ã¾ã›ã‚“ã€‚<br>å¾Œã»ã©å†åº¦ã”ç¢ºèªãã ã•ã„ã€‚</p>
                    </div>`;
                    return;
                }

                grid.innerHTML = data.map(e => createEditorCard(e)).join('');
                console.log('[5] ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºå®Œäº† / ä»¶æ•°:', data.length);
                applyFilters();

            } catch (err) {
                console.error('[ERROR]', err);
                grid.innerHTML = `<div class="loading-state">
                    <div class="icon">âš ï¸</div>
                    <h3>ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼</h3>
                    <p style="color:#ef4444; margin-top:10px;">${err.message}</p>
                    <p style="color:#6b7280; font-size:0.9em; margin-top:5px;">F12ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§è©³ç´°ã‚’ç¢ºèªã—ã¦ãã ã•ã„</p>
                </div>`;
            }
        }

        // ===== ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ =====
        function filterOS(os, btn) {
            selectedOS = os;
            document.querySelectorAll('.filter-btn').forEach(b => {
                if (b.classList.contains('os-windows') || b.classList.contains('os-mac') || b === btn) {
                    b.classList.remove('active');
                }
            });
            document.querySelector('.filter-btn:not(.os-windows):not(.os-mac)').classList.remove('active');
            btn.classList.add('active');
            applyFilters();
        }

        function toggleSoftware(sw, btn) {
            const i = selectedSoftware.indexOf(sw);
            if (i > -1) { selectedSoftware.splice(i, 1); btn.classList.remove('active'); }
            else         { selectedSoftware.push(sw);    btn.classList.add('active'); }
            applyFilters();
        }

        function clearFilters() {
            selectedOS = 'all';
            selectedSoftware = [];
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            document.querySelector('.filter-btn').classList.add('active');
            applyFilters();
        }

        function applyFilters() {
            const cards = document.querySelectorAll('.editor-card');
            let count = 0;
            cards.forEach(card => {
                const cardOS = card.getAttribute('data-os');
                const cardSW = card.getAttribute('data-software').split(',');
                const okOS   = selectedOS === 'all' || cardOS === selectedOS;
                const okSW   = selectedSoftware.length === 0 || selectedSoftware.every(s => cardSW.includes(s));
                card.style.display = (okOS && okSW) ? 'block' : 'none';
                if (okOS && okSW) count++;
            });

            const rc = document.getElementById('resultsCount');
            rc.innerHTML = (selectedOS !== 'all' || selectedSoftware.length > 0)
                ? `<span>${count}å</span>ã®ç·¨é›†è€…ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ` : '';

            const grid = document.getElementById('editorsGrid');
            let noMsg  = document.getElementById('noResults');
            if (count === 0 && cards.length > 0) {
                if (!noMsg) {
                    noMsg = document.createElement('div');
                    noMsg.id = 'noResults';
                    noMsg.style.cssText = 'text-align:center; padding:60px 20px;';
                    noMsg.innerHTML = `<div style="font-size:3em; margin-bottom:20px;">ğŸ˜</div>
                        <h3 style="font-size:2em; color:#1f2937; margin-bottom:10px;">è©²å½“ã™ã‚‹ç·¨é›†è€…ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</h3>
                        <p style="color:#6b7280; margin-bottom:20px;">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã‚’å¤‰æ›´ã—ã¦ã¿ã¦ãã ã•ã„</p>
                        <button class="btn" onclick="clearFilters()">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ã‚¯ãƒªã‚¢</button>`;
                    grid.parentNode.insertBefore(noMsg, grid);
                }
                noMsg.style.display = 'block';
                grid.style.display  = 'none';
            } else {
                if (noMsg) noMsg.style.display = 'none';
                grid.style.display = 'grid';
            }
        }

        function scrollToEditors() {
            document.getElementById('editors').scrollIntoView({ behavior: 'smooth' });
        }

        function showContact(name) {
            alert(name + 'ã¸ã®ç›¸è«‡ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ãã¾ã™ã€‚\n\nãŠåå‰ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ç›¸è«‡å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
        }

        // ===== èµ·å‹•ï¼šãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ã‚’å¾…ã£ã¦ã‹ã‚‰å®Ÿè¡Œ =====
        function waitForSupabaseAndFetch() {
            if (window.supabase && window.supabase.createClient) {
                console.log('[OK] Supabaseãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ç¢ºèª');
                fetchEditors();
            } else {
                console.log('[å¾…æ©Ÿä¸­] Supabaseãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å¾…ã£ã¦ã„ã¾ã™...');
                setTimeout(waitForSupabaseAndFetch, 200);
            }
        }
        document.addEventListener('DOMContentLoaded', waitForSupabaseAndFetch);
    </script>
</body>
</html>
