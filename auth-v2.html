<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shorts Match - ãƒã‚¤ãƒšãƒ¼ã‚¸ v2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 60%, #e0e7ff 100%); }
        .gradient-btn { background: linear-gradient(135deg, #06b6d4, #3b82f6); }
        .card { background: white; border-radius: 24px; box-shadow: 0 4px 24px rgba(0,0,0,0.07); }
        .tool-chip input[type=checkbox] { display:none; }
        .tool-chip input:checked + label {
            background: linear-gradient(135deg, #06b6d4, #3b82f6);
            color: white; border-color: transparent;
        }
        .tool-chip label {
            display: inline-block; padding: 6px 14px; border-radius: 20px;
            border: 2px solid #e2e8f0; background: #f8fafc;
            color: #475569; font-size: 12px; font-weight: 700;
            cursor: pointer; transition: all 0.2s;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">

<main class="max-w-4xl mx-auto px-4 py-12">
    <div class="card p-8">
        <h1 class="text-2xl font-black text-slate-800 mb-6">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è©³ç´°è¨­å®š</h1>
        
        <div class="mb-8">
            <label class="block text-sm font-black text-slate-400 mb-4">ä½¿ç”¨å¯èƒ½ã‚½ãƒ•ãƒˆï¼ˆè¿½åŠ åˆ†å«ã‚€ï¼‰</label>
            <div id="toolsChips" class="flex flex-wrap gap-2">
                </div>
        </div>

        <div id="statusMsg" class="hidden p-4 rounded-xl mb-4 font-bold text-center"></div>
        
        <button onclick="saveProfile()" class="w-full gradient-btn text-white py-4 rounded-2xl font-black shadow-lg">
            ğŸ’¾ ã“ã®è¨­å®šã§ä¿å­˜ã™ã‚‹
        </button>
    </div>
</main>

<script>
    const SUPABASE_URL = 'https://dwmgwdhunvanrsautvtj.supabase.co';
    const SUPABASE_KEY = 'sb_publishable_GzaEGCWBP7y0za2UVPiJNA_N3pdlgJ0';
    const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    // ç«¹ä¸Šã•ã‚“ã®å¸Œæœ›ã«åˆã‚ã›ã¦å¤§å¹…ã«å¢—ã‚„ã—ãŸãƒªã‚¹ãƒˆ
    const additionalTools = [
        'Premiere Pro', 'After Effects', 'DaVinci Resolve', 'Final Cut Pro',
        'LumaFusion', 'Vrew', 'CapCut', 'Photoshop', 'Canva',
        'VEGAS Pro', 'Avid', 'AviUtl', 'Blender', 'Illustrator', 'Filmora'
    ];

    function renderTools() {
        const container = document.getElementById('toolsChips');
        container.innerHTML = additionalTools.map(tool => `
            <span class="tool-chip">
                <input type="checkbox" id="t-${tool.replace(/\s+/g, '')}" value="${tool}">
                <label for="t-${tool.replace(/\s+/g, '')}">${tool}</label>
            </span>
        `).join('');
    }

    async function saveProfile() {
        const { data: { user } } = await sb.auth.getUser();
        if (!user) return alert('ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™');

        const selectedTools = Array.from(document.querySelectorAll('#toolsChips input:checked')).map(cb => cb.value);
        
        const { error } = await sb.from('editors').upsert({
            id: user.id,
            tools: selectedTools
        });

        const msg = document.getElementById('statusMsg');
        msg.classList.remove('hidden');
        if (error) {
            msg.textContent = 'âŒ ã‚¨ãƒ©ãƒ¼: ' + error.message;
            msg.className = 'p-4 rounded-xl mb-4 font-bold text-center bg-red-50 text-red-600';
        } else {
            msg.textContent = 'âœ… ã‚½ãƒ•ãƒˆä¸€è¦§ã‚’æ›´æ–°ã—ã¾ã—ãŸï¼';
            msg.className = 'p-4 rounded-xl mb-4 font-bold text-center bg-emerald-50 text-emerald-600';
        }
    }

    window.onload = renderTools;
</script>
</body>
</html>
